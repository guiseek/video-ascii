const L=function(){const r=document.createElement("link").relList;if(r&&r.supports&&r.supports("modulepreload"))return;for(const e of document.querySelectorAll('link[rel="modulepreload"]'))s(e);new MutationObserver(e=>{for(const t of e)if(t.type==="childList")for(const c of t.addedNodes)c.tagName==="LINK"&&c.rel==="modulepreload"&&s(c)}).observe(document,{childList:!0,subtree:!0});function n(e){const t={};return e.integrity&&(t.integrity=e.integrity),e.referrerpolicy&&(t.referrerPolicy=e.referrerpolicy),e.crossorigin==="use-credentials"?t.credentials="include":e.crossorigin==="anonymous"?t.credentials="omit":t.credentials="same-origin",t}function s(e){if(e.ep)return;e.ep=!0;const t=n(e);fetch(e.href,t)}};L();function p(o,r=document.body){return r.querySelector(o)}const w=(()=>{let o,r,n,s,e;const t=()=>{r=document.createElement("video"),r.setAttribute("width",o.width+""),r.setAttribute("height",o.height+""),r.setAttribute("playsinline","true"),r.setAttribute("webkit-playsinline","true"),"getUserMedia"in navigator.mediaDevices?navigator.mediaDevices.getUserMedia({video:!0,audio:!1}).then(a=>{o.onSuccess(),r.srcObject=a,c()}).catch(o.onError):o.onNotSupported()};function c(){n=o.targetCanvas||document.createElement("canvas"),n.setAttribute("width",o.width+""),n.setAttribute("height",o.height+""),s=n.getContext("2d"),o.mirror&&(s.translate(n.width,0),s.scale(-1,1))}function v(){r.play(),e=setInterval(function(){try{s.drawImage(r,0,0,r.width,r.height),o.onFrame(n)}catch{}},Math.round(1e3/o.fps))}function f(){g(),r.srcObject=null}function g(){e&&clearInterval(e),r.pause()}function m(a={}){var u,d,y,i,h,b,C,M,S;const l=()=>null;return{fps:(u=a.fps)!=null?u:30,width:(d=a.width)!=null?d:640,height:(y=a.height)!=null?y:480,mirror:(i=a.mirror)!=null?i:!1,targetCanvas:(h=a.targetCanvas)!=null?h:null,onSuccess:(b=a.onSuccess)!=null?b:l,onError:(C=a.onError)!=null?C:l,onNotSupported:(M=a.onNotSupported)!=null?M:l,onFrame:(S=a.onFrame)!=null?S:l}}return{init:a=>{o=m(a),t()},start:v,pause:g,stop:f}})(),k=(()=>{const o=(e,t)=>{const c=" .,:;i1tfLCG08@".split(""),v=e.getContext("2d"),f=e.width,g=e.height;let m="";const a=259*(t.contrast+255)/(255*(259-t.contrast)),l=v.getImageData(0,0,f,g);for(let u=0;u<g;u+=2){for(let d=0;d<f;d++){const y=(u*f+d)*4,i=r(l.data,y),h={red:n(Math.floor((i.red-128)*a)+128,[0,255]),green:n(Math.floor((i.green-128)*a)+128,[0,255]),blue:n(Math.floor((i.blue-128)*a)+128,[0,255]),alpha:i.alpha},b=(.299*h.red+.587*h.green+.114*h.blue)/255;m+=c[c.length-1-Math.round(b*(c.length-1))]}m+=`
`}t.callback(m)};function r(e,t){return{red:e[t],green:e[t+1],blue:e[t+2],alpha:e[t+3]}}function n(e,t){return Math.max(t[0],Math.min(t[1],e))}function s(e={}){var t,c;return{contrast:(t=e==null?void 0:e.contrast)!=null?t:0,callback:(c=e==null?void 0:e.callback)!=null?c:()=>{}}}return{fromCanvas:(e,t)=>{const c=s(t);return o(e,c)}}})();document.addEventListener("DOMContentLoaded",()=>{const o=p("#ascii");let r=!1;w.init({fps:30,width:160,height:120,mirror:!0,onFrame:n=>{k.fromCanvas(n,{callback:s=>{o.innerHTML=s}})},onSuccess:function(){p("#info").style.display="none";const n=p("#button");n.style.display="block",n.onclick=()=>{r?(w.pause(),n.innerText="resume"):(w.start(),n.innerText="pause"),r=!r}},onError:({message:n})=>{console.error(n)},onNotSupported:()=>{p("#info").style.display="none",o.style.display="none",p("#notSupported").style.display="block"}})});
